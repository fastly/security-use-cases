{
    "time":"%{begin:%Y-%m-%dT%H:%M:%SZ}t",
    "data":  {
        "service_id":"%{req.service_id}V",
        "time_elapsed":%D,
        "request":"%m",
        "host":"%{if(req.http.Fastly-Orig-Host, req.http.Fastly-Orig-Host, req.http.Host)}V",
        "url":"%{cstr_escape(req.url)}V",
        "protocol":"%H",
        "is_ipv6":%{if(req.is_ipv6, "true", "false")}V,
        "is_tls":%{if(req.is_ssl, "true", "false")}V,
        "is_h2":%{if(fastly_info.is_h2, "true", "false")}V,
        "client_ip":"%h",
        "geo_city":"%{client.geo.city.utf8}V",
        "geo_country_code":"%{client.geo.country_code}V",
        "server_datacenter":"%{server.datacenter}V",
        "request_referer":"%{Referer}i",
        "request_user_agent":"%{User-Agent}i",
        "request_accept_content":"%{Accept}i",
        "request_accept_language":"%{Accept-Language}i",
        "request_accept_charset":"%{Accept-Charset}i",
        "cache_status":"%{regsub(fastly_info.state, "^(HIT-(SYNTH)|(HITPASS|HIT|MISS|PASS|ERROR|PIPE)).*", "\2\3") }V",
        "status":%{resp.status}V,
        "content_type":"%{Content-Type}o",
        "req_header_size":%{req.header_bytes_read}V,
        "req_body_size":%{req.body_bytes_read}V,
        "resp_header_size":%{resp.header_bytes_written}V,
        "resp_body_size":%{resp.body_bytes_written}V,
        "sigsci-agentresponse":%{req.http.x-sigsci-agentresponse}V,
        "sigsci-decision-ms":%{req.http.x-sigsci-decision-ms}V,
        "sigsci-tags":"%{req.http.x-sigsci-tags}V"
    }
}
